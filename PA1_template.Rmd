---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data

First things first, I'll use `read.csv` to add data to data frame `x`.

```{r workingDirectory, echo=FALSE}
setwd("~/Documents/R/RepData_PeerAssessment1")
```

```{r}
x <- read.csv("activity.csv", colClasses = c("integer", "character", "integer"))
```

Next, the date will be converted to POSIXct format using the `strptime` command and stored in the column `newDate`.

```{r}
x$newDate <- as.POSIXct(strptime(x$date, '%Y-%m-%d'))
```

## What is mean total number of steps taken per day?
First, make a histogram of the total number of steps taken each day.  For this part of the assignment, missing values can be ignored.

```{r histogram1}
hist(x$steps, main = "Histogram of number of steps taken each day", xlab = "number of steps")
```

In this next part of the assignment, the mean and median total number of steps is calculated and reported.  

```{r computeMeanMedian}
meanSteps <- mean(x$steps, na.rm = TRUE)
medianSteps <- median(x$steps, na.rm = TRUE)
```

The mean number of steps taken per day is `r meanSteps` and the median number of steps taken is `r medianSteps`.
    
## What is the average daily activity pattern?

A time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis) is created.  For this part of the assignment, I'm using the `dplyr` package and creating a new data frame named `x2`.

```{r, echo=FALSE, message=FALSE}
library(dplyr)
```

```{r activityPattern}
x2 <- summarize(group_by(x, interval), v = mean(steps, na.rm = TRUE))
plot(x2$interval, x2$v, type = "l", main = "Average Daily Activity Pattern", 
     xlab = "5-minute interval", 
     ylab = "average number of steps taken")
maxInterval <- x2$interval[which.max(x2$v)]
```

Interval number `r maxInterval` has the highest average number of steps.

## Imputing missing values (sic)

In this part of the assignment, the total number of missing values in the dataset is calculated and reported.  The total number of missing values is easily calculated using the `is.na` command.

```{r sumNA}
sumNA <- sum(is.na(x))
```

There are `r sumNA` missing values in the data set.

My strategy for filling in all of the missing values in the dataset is to assign all missing values to zero.  Since all missing values are in the `steps` column, I'll create a new column called `steps2` with all of the missing data filled in.

```{r computeMeanMedian2}
x$steps2 <- x$steps
x$steps2[is.na(x$steps)] <- 0
meanSteps2 <- mean(x$steps2, na.rm = TRUE)
medianSteps2 <- median(x$steps2, na.rm = TRUE)
```

Make a histogram of the total number of steps taken each day and Calculate and report the mean and median total number of steps taken per day. Do these values differ from the estimates from the first part of the assignment? What is the impact of imputing missing data on the estimates of the total daily number of steps?

```{r histogram2}
hist(x$steps2, main = "Histogram of number of steps taken each day", xlab = "number of steps")
```

Now we can compare the impact of removing the missing values.  

In the data set with missing values, the mean was `r meanSteps` and the median number of steps taken was `r medianSteps`.  The lower mean value isn't surprising given my replacement strategy.

With the missing values removed, the mean is now `r meanSteps2` and the median is now `r medianSteps2`.

## Are there differences in activity patterns between weekdays and weekends?

First, I'll create a new factor variable in the `x` dataset with two levels – “weekday” and “weekend” indicating whether a given date is a weekday or weekend day.

```{r}
x$dayType <- as.character(weekdays(x$newDate))
x$dayType[x$dayType %in% c("Saturday", "Sunday")] <- "weekend"
x$dayType[x$dayType %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")] <- "weekday"
```

Next, I'll create a dataset `x3` that contains the average number of steps for each interval for both days, classified by type (weekend or weekday).

```{r}
xWE <- filter(x, dayType == "weekend")
xWE2 <- summarize(group_by(xWE, interval), v = mean(steps, na.rm = TRUE))
xWE2$type <- "weekend"
xWD <- filter(x, dayType == "weekday")
xWD2 <- summarize(group_by(xWD, interval), v = mean(steps, na.rm = TRUE))
xWD2$type <- "weekday"
x3 <- rbind(xWE2, xWD2)
```

Finally, I'll use the `lattice` plotting system to make a panel plot containing a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis).

``` {r, echo=FALSE}
library(lattice)
```

```{r panel}
xyplot(v ~ interval | type, data = x3, type = "l", layout =c(1, 2), xlab = "interval", ylab = "Number of steps")
```
